
id: 10_gcp_taxi_backfill_2021
namespace: zoomcamp
description: |
  Homework Challenge: Backfill 2021 data (Jan-Jul) for Yellow and Green taxis using Subflows.

tasks:
  - id: for_each_month
    type: io.kestra.plugin.core.flow.ForEach
    values: ["01", "02", "03", "04", "05", "06", "07"]
    tasks:
      - id: backfill_green
        type: io.kestra.plugin.core.flow.Subflow
        flowId: 08_gcp_taxi_etl
        namespace: zoomcamp
        inputs:
          taxi: green
          year: "2021"
          month: "{{taskrun.value}}"
          
      - id: backfill_yellow
        type: io.kestra.plugin.core.flow.Subflow
        flowId: 08_gcp_taxi_etl
        namespace: zoomcamp
        inputs:
          taxi: yellow
          year: "2021"
          month: "{{taskrun.value}}"
